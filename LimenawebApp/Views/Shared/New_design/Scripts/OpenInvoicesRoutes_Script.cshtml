
@{
    Layout = null;
}



<script>

 

    

        function PrintRoute(id_route) {

            swal.fire({
                title: 'Are you sure to print this route?',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3dba6f',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'Yes'
            }).then((result) => {
                if (result.value) {
                    $("#loader").show();
                    $.ajax({
                        url: '/Invoices/Print_route',
                        type: 'POST',
                        data: { 'id': id_route },
                        cache: false,
                        global: false,
                        success: function (result) {

                            if (result == "success") {
                                $("#loader").hide();
                                Swal.fire(
                                    'Route printed',
                                    '',
                                    'success'
                                )
                                //window.location.reload(true);
                            } else {
                                alert("Something went wrong.."); $("#loader").hide();
                            }


                        },
                        error: function (request) {
                            alert("Something went wrong.."); $("#loader").hide();

                        }
                    });

                }
            })
        }
        function PrintRouteWHS(id_route) {

            swal.fire({
                title: 'Are you sure to print this route?',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3dba6f',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'Yes'
            }).then((result) => {
                if (result.value) {
                    $("#loader").show();
                    $.ajax({
                        url: '/Invoices/Print_routeWHS',
                        type: 'POST',
                        data: { 'id_route': id_route },
                        cache: false,
                        global: false,
                        success: function (result) {

                            if (result == "Success") {
                                $("#loader").hide();
                                window.open('@Url.Action("Route_WHSInvoices", "Invoices",new { activityname = "Route_WHSInvoices" })', '_blank');
                            } else if (result == "CountError"){
                                alert("No data found.");
                                $("#loader").hide();
                            }

                            else {
                                alert(result);
                                $("#loader").hide();
                            }


                        },
                        error: function (request) {
                            alert("Error: something went wrong..");
                            $("#loader").hide();
                        }
                    });

                }
            })
        }

    //TN Nashville 11/27/2020
    function PrintRouteTNWMS(id_route) {

            swal.fire({
                title: 'Are you sure to preview this route?',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3dba6f',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'Yes'
            }).then((result) => {
                if (result.value) {
                    $("#loader").show();
                    $.ajax({
                        url: '/Invoices/Print_routeTN_WHS',
                        type: 'POST',
                        data: { 'id_route': id_route },
                        cache: false,
                        global: false,
                        success: function (result) {

                            if (result == "Success") {
                                $("#loader").hide();
                                window.open('@Url.Action("Route_WHSInvoices", "Invoices",new { activityname = "Route_WHSInvoices" })', '_blank');
                            } else if (result == "CountError"){
                                alert("No data found.");
                                $("#loader").hide();
                            }

                            else {
                                alert(result);
                                $("#loader").hide();
                            }


                        },
                        error: function (request) {
                            alert("Error: something went wrong..");
                            $("#loader").hide();
                        }
                    });

                }
            })
        }

        function PrintRouteTNWMSBarcode(id_route) {

            swal.fire({
                title: 'Are you sure to preview this route?',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3dba6f',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'Yes'
            }).then((result) => {
                if (result.value) {
                    $("#loader").show();
                    $.ajax({
                        url: '/Invoices/Print_routeTN_barcode',
                        type: 'POST',
                        data: { 'id_route': id_route },
                        cache: false,
                        global: false,
                        success: function (result) {

                            if (result == "Success") {
                                $("#loader").hide();
                                window.open('@Url.Action("Route_WHSInvoices", "Invoices",new { activityname = "Route_WHSInvoices" })', '_blank');
                            } else if (result == "CountError"){
                                alert("No data found.");
                                $("#loader").hide();
                            }

                            else {
                                alert(result);
                                $("#loader").hide();
                            }


                        },
                        error: function (request) {
                            alert("Error: something went wrong..");
                            $("#loader").hide();
                        }
                    });

                }
            })
        }

    ////
        function PrintDailyPayment(id_route) {

            swal.fire({
                title: 'Are you sure to print the Daily Payment Report for this Route?',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3dba6f',
                cancelButtonColor: '#aaa',
                confirmButtonText: 'Yes'
            }).then((result) => {
                if (result.value) {

                    $.ajax({
                        url: '/Invoices/Print_WHSDailyPayment',
                        type: 'POST',
                        data: { 'id_route': id_route },
                        cache: false,
                        global: false,
                        success: function (result) {

                            if (result == "Success") {

                                window.open('@Url.Action("DailyPaymentCrossDock", "Invoices",new { activityname = "DailyPaymentCrossDock" })', '_blank');
                            } else if (result == "CountError"){
                                alert("No data found.");
                            }

                            else {
                                alert(result);
                            }


                        },
                        error: function (request) {
                            alert("Error: something went wrong..");

                        }
                    });

                }
            })
        }


       

    window.onload = function () {
        $(document).ready(function () {


            $('#data_tableEditor').DataTable({
                dom: 'Bfrtip',
                select: true
            });

            try {
                $('#data_tableEditor2').DataTable({
                    dom: 'Bfrtip',
                    select: true
                });
            } catch{

            }

            var flag = 0;
            //DATETIMEPICKER
            var t1 = "@ViewBag.filtrofechastart";
            var t2 = "@ViewBag.filtrofechaend";

            var start = moment(t1, "MM-DD-YYYY");
            var end = moment(t2, "MM-DD-YYYY");

            function cb(start, end) {
                $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
                if (flag == 0) {
                    flag = 1;
                } else {
                    filterSObydate();
                }


            }

            $('#reportrange').daterangepicker({

                startDate: start,
                endDate: end,
                autoApply: false,
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                }
            }, cb);

            cb(start, end);


        @*function filterSObydate() {
            var st = new Date($('#reportrange').data('daterangepicker').startDate);
            var ed = new Date($('#reportrange').data('daterangepicker').endDate);

            st = st.toLocaleDateString();
            ed = ed.toLocaleDateString();
            //colocamos la url de la demo
            var url = 'Url.Action("QualityControl_planning", "Invoices", new { fstartd = "dad", fendd="tfe" })';
            url = url.replace('dad', st);
            var newurl = url;
            newurl = newurl.replace('tfe', ed);

            newurl = newurl.replace(/&amp;/g, "&");

            window.location.href = newurl;
        };*@



            function filterSObydate() {
                var st = new Date($('#reportrange').data('daterangepicker').startDate);
                var ed = new Date($('#reportrange').data('daterangepicker').endDate);

                //st = st.toLocaleDateString();
                //ed = ed.toLocaleDateString();
                ////colocamos la url de la demo



                var today = st;
                var dd = today.getDate();
                var mm = today.getMonth() + 1; //January is 0!

                var yyyy = today.getFullYear();
                if (dd < 10) {
                    dd = '0' + dd;
                }
                if (mm < 10) {
                    mm = '0' + mm;
                }
                st = mm + '/' + dd + '/' + yyyy;

                var today2 = ed;
                var dd2 = today2.getDate();
                var mm2 = today2.getMonth() + 1; //January is 0!

                var yyyy2 = today2.getFullYear();
                if (dd2 < 10) {
                    dd2 = '0' + dd2;
                }
                if (mm2 < 10) {
                    mm2 = '0' + mm2;
                }
                ed = mm2 + '/' + dd2 + '/' + yyyy2;

                var url = '@Url.Action("OpenInvoicesRoutes", "Invoices", new { fstartd = "dad", fendd="tfe" })';
                url = url.replace('dad', st);
                var newurl = url;
                newurl = newurl.replace('tfe', ed);

                newurl = newurl.replace(/&amp;/g, "&");

                window.location.href = newurl;
            };

        });
            }
</script>