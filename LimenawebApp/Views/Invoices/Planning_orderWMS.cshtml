@model List<LimenawebApp.Models.Tb_PlanningSO>
@{
    ViewBag.Title = "Distribuidora Limeña - Planning orderWMS";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
    LimenawebApp.Models.Sys_Users activeuser = (LimenawebApp.Models.Sys_Users)ViewBag.activeuser;
    List<LimenawebApp.Controllers.InvoicesController.APIMessageDetails> lstfailed = (List<LimenawebApp.Controllers.InvoicesController.APIMessageDetails>)ViewBag.lstfailed;
   
}

<div class="page__header">
    <div class="container-fluid page__heading-container">
        <div class="page__heading d-flex align-items-center">
            <div class="flex">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="#">Operations</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Planning WMS</li>
                    </ol>
                </nav>
                <h1 class="m-0">Planning WMS</h1>
            </div>

        </div>
    </div>
</div> <!-- // END page__header -->
<!--Page Header menu-->
@Html.Partial("~/Views/Shared/New_design/Menus/Operations.cshtml")

<div class="container-fluid page__container">
    <div class="container-fluid page__container">
        <div class="row">
            <div class="col-lg-12">
                <div class="z-0">
                    <ul class="nav nav-tabs nav-tabs-custom" role="tablist">
                        <li class="nav-item">
                            <a href="#tab-21" class="nav-link active" data-toggle="tab" role="tab" aria-controls="tab-21" aria-selected="true">
                                <span class="nav-link__count">01</span>
                                Sales Orders and Invoices
                            </a>
                        </li>
                        @if (lstfailed.Count > 0)
    {
                    <li class="nav-item">
                        <a href="#tab-22" class="nav-link" data-toggle="tab" role="tab" aria-selected="false">
                            <span class="nav-link__count">02</span>
                            Active Log
                        </a>
                    </li>
}


                    </ul>
                    <div class="card">
                        <div class="card-body tab-content">
                            <div class="tab-pane active show fade" id="tab-21">
                                       
                <div class="card-header border-0">
                    <div class="custom-title-wrap bar-info">

                        <div class=" widget-action-link">

                            <a class="btn  btn btn-secondary" style="font-size:14px;" href="@Url.Action("PlanningRoutes", "Invoices")">Back</a>
                            <button class="btn  btn btn-info float-right" style="font-size:14px;" data-toggle="modal" data-target="#modal_invoices">Add Invoices</button>
                            <button class="btn  btn btn-info float-right" style="font-size:14px;" data-toggle="modal" data-target="#modal_SO">Add Sales Order</button>

                            <input type="text" id="selectedRoute" hidden value="@ViewBag.id_route" />
                        </div>
                    </div>
                </div>
                <div class="card-body pt-3 pb-4">
                    <div class="table-responsive">
                        <a href="#" class="btn btn-sm btn-warning" onclick="changeOrder()">CLEAR SORTS</a>
                        <table id="tbOrder" class="table">
                            <thead>
                                <tr>
                                    <th>ORDER</th>
                                    <th style="display:none">#</th>
                                    <th>DOC NUM</th>
                                    <th>ID CUSTOMER</th>
                                    <th>CUSTOMER</th>
                                    <th>ROUTE</th>
                                    <th>REP</th>
                                    <th>DATE</th>
                                    <th>AMOUNT</th>
                                    <th>COMMENT</th>
                                    <th>Type</th>
                                    <th></th>

                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr style="font-size:12px;font-weight:normal !important;">
                                        <td><input type="text" class="form-control" style="width:60px;" value="@item.query3" min="0" step="1" onkeypress="return event.charCode >= 48 && event.charCode <= 57" title="Numbers only" /> </td>
                                        <td style="display:none;">@item.ID_salesorder</td>
                                        @if (item.ID_customer[0] == 'C')
                                        {
                                            <td><span style="color:black !important; font-size:12px;" class="badge badge-warning text-light form-pill px-3 py-1">@item.SAP_docnum</span></td>
                                        }
                                        else
                                        {
                                            <td><span style="color:black !important; font-size:12px;" class="badge badge-info text-light form-pill px-3 py-1">@item.SAP_docnum</span></td>
                                        }



                                        <td>@item.ID_customer</td>
                                        <td>@item.Customer_name</td>
                                        <td>@item.query2</td>
                                        <td>@item.Rep_name</td>
                                        <td>@Convert.ToDateTime(item.SAP_docdate).ToShortDateString()</td>
                                        <td>$@Convert.ToDecimal(item.Amount).ToString("n2")</td>
                                        <td><textarea>@item.query4</textarea> </td>

                                        <td>
                                            @if (item.query5 == "Invoice")
                                            {<label class="badge badge-primary">Invoice</label>}
                                            else
                                            { <label class="badge badge-success">Sales Order</label>}
                                    </td>
                                    <td><button type="button" class="btn btn-danger" onclick="deleteSO(@item.ID_salesorder)">Delete</button></td>
                                </tr>
                            }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th colspan="2"></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th colspan="3"></th>





                                </tr>
                            </tfoot>
                        </table>
                    </div>

               
                <div class="float-left">
                    <span style="color:black !important" class="badge badge-warning text-light form-pill px-3 py-1">LIMENA</span>
                    <span style="color:black !important" class="badge badge-info text-light form-pill px-3 py-1">BAR-S</span>

                </div>

            </div>
            <div class="float-right">
                <a href="#" class="btn btn-success" onclick="saveOrderData()">Save</a>
                @if (activeuser.Roles.Contains("PrintAdmin"))
                {
                    <a href="@Url.Action("Print_Roadmap", "Invoices", new { id = ViewBag.id_route })" class="btn btn-info" target="_blank">print</a>
                }


            </div>
            <br /><br />
                            </div>
                            <div class="tab-pane" id="tab-22">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Docnum</th>
                                            <th>Error Message</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (lstfailed.Count > 0)
            {
                foreach (var fail in lstfailed)
                {
                            <tr>
                                <td>@fail.SO</td>
                                <td>@fail.Error</td>
                            </tr>
}
}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>
                   



        
            <!--/main content wrapper-->
