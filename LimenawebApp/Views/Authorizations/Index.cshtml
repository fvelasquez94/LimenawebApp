@model List<LimenawebApp.Models.Authorizations.Authorizations_api>
@{
    ViewBag.Title = "Authorizations";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";

    DateTime fechasel = new DateTime(2000,01,01);
}


<div class="page__header">
    <div class="container-fluid page__heading-container">
        <div class="page__heading d-flex align-items-center">
            <div class="flex">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="#">Finance</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Authorizations</li>
                    </ol>
                </nav>
                <h1 class="m-0">Authorizations</h1>
            </div>

        </div>
    </div>
</div> <!-- // END page__header -->
<!--Page Header menu-->
<div class="page__header page__header-nav">
    <div class="container-fluid page__container">
        <div class="navbar navbar-secondary navbar-light navbar-expand-sm p-0">
        
        </div>
    </div>
</div>

<div class="container-fluid page__container">
    <div class="card card-form d-flex flex-column flex-sm-row">
        <div class="card-form__body card-body-form-group flex">
            <div class="row">
                <div class="col-sm-auto">
                    <div class="form-group">
                        <label for="filter_name">Search</label>
                        <input id="filter_name" type="text" class="form-control" placeholder="Enter keyword">
                    </div>
                </div>
                @*<div class="col-sm-auto">
                    <div class="form-group">
                        <label for="filter_buckets">Customers</label><br>
                        <select id="filter_buckets" class="custom-select" style="width: 150px;">
                            <option value="all">Any</option>
                            <option value="S000474">S000474 - DISTRIBUIDORA MARKET #2</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-auto">
                    <div class="form-group">
                        <label for="filter_assigned">Driver</label><br>
                        <select id="filter_assigned" class="custom-select" style="width: 150px;">
                            <option value="all">Any</option>
                            <option value="1">Adrian D.</option>
                            <option value="2">Michael S.</option>
                            <option value="3">John L.</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-auto">
                    <div class="form-group">
                        <label for="filter_assigned">Status</label><br>
                        <select id="filter_assigned" class="custom-select" style="width: 150px;">
                            <option value="all">Any</option>
                            <option value="1">Waiting for</option>
                            <option value="2">Approved</option>
                            <option value="3">Denied</option>
                        </select>
                    </div>
                </div>*@
                <div class="col-sm-auto">
                    <div class="form-group" style="width: 200px;">
                        <label for="filter_date">Daterange</label>
                        <input id="filter_date" type="text" class="form-control" placeholder="Range example" data-toggle="daterangepicker" data-daterangepicker-start-date="@Convert.ToDateTime(ViewBag.filtrofechastart).ToString("yyyy/MM/dd")" data-daterangepicker-end-date="@Convert.ToDateTime(ViewBag.filtrofechaend).ToString("yyyy/MM/dd")">
                        
                    </div>
                </div>
            </div>
        </div>

    </div>
    @if (Model != null)
    {
        if (Model.Count > 0)
        {
            foreach (var item in Model)
            {
                if (item.date.Value.ToShortDateString() != fechasel.ToShortDateString())
                {
                    <p class="text-dark-gray d-flex align-items-center mt-3">
                        <i class="material-icons icon-muted mr-2">event</i>
                        <strong>@item.date.Value.ToLongDateString()</strong>
                    </p>

                    fechasel = item.date.Value;
                }

                <div class="row align-items-center projects-item mb-1 rowcustom">
                    <div class="col-sm-auto mb-1 mb-sm-0">
                        <div class="text-dark-gray">@item.date.Value.ToShortTimeString()</div>
                    </div>
                    <div class="col-sm">
                        <div class="card m-0">
                            <div class="px-4 py-3">
                                <div class="row align-items-center">
                                    <div class="col" style="min-width: 300px">
                                        <div class="d-flex align-items-center">
                                            <label class="text-body"><strong class="text-15pt mr-2">@item.cardCode - @item.cardName</strong></label>
                                            @if (item.status == 0)
                                            {
                                                <span class="badge badge-warning">WAITING FOR AN ANSWER</span>
                                            }
                                            else if (item.status == 1)
                                            {
                                                <span class="badge badge-success">APPROVED</span>
                                            }
                                            else
                                            {
                                                <span class="badge badge-danger">DENIED</span>
                                            }
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <small class="mr-2">@item.idReason - @item.reason</small>

                                        </div>
                                    </div>
                                    <div class="col-auto d-flex align-items-center">
                                        <i class="material-icons icon-muted icon-20pt mr-2">local_shipping</i>
                                        <label class="text-body">@item.idRoute</label>
                                    </div>
                                    <div class="col-auto d-flex align-items-center">
                                        <i class="material-icons icon-muted icon-20pt mr-2">account_circle</i>
                                        <label class="text-body">@item.idDriver</label>
                                    </div>
                                    @if (item.status == 0)
                                    {
                                        <div class="col-auto d-flex align-items-center" style="min-width: 140px;">
                                            <a href="#" data-customer="@item.cardName" data-authcode="@item.idAuthorization" data-idreason="@item.idReason" data-reason="@item.reason" data-driver="@item.idDriver" data-route="@item.idRoute" data-date="@item.date" data-financeuser="@item.idFinanceUser" data-drivercomm="@item.comments" data-commentsfinance="@item.commentsFinance" data-toggle="modal" data-target="#modal-authorizations" class="text-dark-gray">DETAILS</a>
                                            <i class="material-icons icon-muted icon-20pt ml-2">folder</i>
                                        </div>
                                    }

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {

                <p class="text-dark-gray d-flex align-items-center mt-3">
                    <i class="material-icons icon-muted mr-2"></i>
                    <strong>No data to show</strong>
                </p>
        }
    }
    else
    {

                <p class="text-dark-gray d-flex align-items-center mt-3">
                    <i class="material-icons icon-muted mr-2"></i>
                    <strong>No data to show</strong>
                </p>
    }

</div>
